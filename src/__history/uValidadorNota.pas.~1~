unit uValidadorNota;

interface

type
  TValidadorNota = class
  public
    class function EhNumeroOuVirgulaOuBackspace(Key: Char): Boolean;
    class function EhPrimeiroCaractereVirgula(const Texto: string; Key: Char): Boolean;
    class function JaTemVirgula(const Texto: string; Key: Char): Boolean;
    class function ZeroAEsquerda(const Texto: string; Key: Char): Boolean;
    class function MaisDeDuasCasasDecimais(const Texto: string; Key: Char): Boolean;
    class function ForaDoIntervalo(const TextoSimulado: string): Boolean;
  end;

implementation

uses
  System.SysUtils;

{ Implementações }

class function TValidadorNota.EhNumeroOuVirgulaOuBackspace(Key: Char): Boolean;
begin
  Result := Key in ['0'..'9', ',', #8];
end;

class function TValidadorNota.EhPrimeiroCaractereVirgula(const Texto: string; Key: Char): Boolean;
begin
  Result := (Key = ',') and (Texto = '');
end;

class function TValidadorNota.JaTemVirgula(const Texto: string; Key: Char): Boolean;
begin
  Result := (Key = ',') and (Pos(',', Texto) > 0);
end;

class function TValidadorNota.ZeroAEsquerda(const Texto: string; Key: Char): Boolean;
begin
  Result := (Length(Texto) = 1) and (Texto[1] = '0') and (Key in ['0'..'9']);
end;

class function TValidadorNota.MaisDeDuasCasasDecimais(const Texto: string; Key: Char): Boolean;
var
  PosVirgula: Integer;
begin
  PosVirgula := Pos(',', Texto);
  Result := (PosVirgula > 0) and (Key in ['0'..'9']) and (Length(Texto) - PosVirgula >= 2);
end;

class function TValidadorNota.ForaDoIntervalo(const TextoSimulado: string): Boolean;
var
  Valor: Double;
begin
  Result := False;
  try
    if (TextoSimulado <> '') and (TextoSimulado[Length(TextoSimulado)] <> ',') then
    begin
      Valor := StrToFloat(TextoSimulado);
      Result := (Valor < 0) or (Valor > 10);
    end;
  except
    Result := True; // Qualquer erro de conversão é inválido
  end;
end;

end.

